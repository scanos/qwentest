// Initialize the map
const map = L.map('map').setView([pubs[0].lat, pubs[0].lng], 15);

// Add OpenStreetMap tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: 'Â© OpenStreetMap contributors'
}).addTo(map);

// Add the first marker and label
let currentIndex = 0;
let currentMarker = L.marker([pubs[currentIndex].lat, pubs[currentIndex].lng])
    .addTo(map)
    .bindPopup(pubs[currentIndex].name)
    .openPopup();

// Function to handle marker click
currentMarker.on('click', function () {
    if (currentIndex < pubs.length - 1) {
        currentIndex++;

        // Remove old marker and popup
        map.removeLayer(currentMarker);

        // Draw a line from the old location to the new location
        const polyline = L.polyline([
            [pubs[currentIndex - 1].lat, pubs[currentIndex - 1].lng],
            [pubs[currentIndex].lat, pubs[currentIndex].lng]
        ], { color: 'blue' }).addTo(map);

        // Add the new marker and label
        currentMarker = L.marker([pubs[currentIndex].lat, pubs[currentIndex].lng])
            .addTo(map)
            .bindPopup(pubs[currentIndex].name)
            .openPopup();

        // Center the map on the new location
        map.setView([pubs[currentIndex].lat, pubs[currentIndex].lng], 15);
    }
});