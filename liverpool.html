<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Ten Pubs in Liverpool</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Define the top ten pubs in Liverpool with their coordinates
        const pubs = [
            { name: "The Philharmonic", lat: 53.406297, lng: -2.966437 },
            { name: "The Cavern Club", lat: 53.406197, lng: -2.992134 },
            { name: "The Shipping Forecast", lat: 53.407538, lng: -2.986453 },
            { name: "The Baltic Fleet", lat: 53.403199, lng: -2.986127 },
            { name: "The Slaughter House", lat: 53.405396, lng: -2.985783 },
            { name: "The Crown", lat: 53.405823, lng: -2.989135 },
            { name: "The Grapes", lat: 53.406432, lng: -2.985584 },
            { name: "The Bridewell", lat: 53.404379, lng: -2.984356 },
            { name: "The Alma de Cuba", lat: 53.404917, lng: -2.988524 },
            { name: "The Botanical Garden", lat: 53.405682, lng: -2.986634 }
        ];

        // Initialize the map
        const map = L.map('map').setView([pubs[0].lat, pubs[0].lng], 15);

        // Add OpenStreetMap tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        let currentStep = 0; // Track the current step
        let polyline; // To store the polyline

        // Function to add a marker and label
        function addMarker(pub) {
            const marker = L.marker([pub.lat, pub.lng]).addTo(map);
            marker.bindPopup(pub.name).openPopup();
            return marker;
        }

        // Function to draw a line between two points
        function drawLine(from, to) {
            if (polyline) {
                map.removeLayer(polyline); // Remove the previous line
            }
            polyline = L.polyline([[from.lat, from.lng], [to.lat, to.lng]], { color: 'blue' }).addTo(map);
        }

        // Function to handle marker click
        function handleMarkerClick() {
            if (currentStep < pubs.length - 1) {
                const currentPub = pubs[currentStep];
                const nextPub = pubs[currentStep + 1];

                // Draw a line from the current location to the next location
                drawLine(currentPub, nextPub);

                // Center the map on the next location
                map.setView([nextPub.lat, nextPub.lng], 15);

                // Remove the current marker
                map.eachLayer(layer => {
                    if (layer instanceof L.Marker) {
                        map.removeLayer(layer);
                    }
                });

                // Add a marker for the next location
                const nextMarker = addMarker(nextPub);

                // Attach the click event to the new marker
                nextMarker.on('click', handleMarkerClick);

                // Increment the step counter
                currentStep++;
            } else {
                alert("You've visited all the pubs!");
            }
        }

        // Start by adding the first marker
        const firstMarker = addMarker(pubs[0]);
        firstMarker.on('click', handleMarkerClick);
    </script>
</body>
</html>