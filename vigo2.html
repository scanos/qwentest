<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vigo Attractions</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map {
      height: 600px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>Vigo Attractions Map</h1>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Define Vigo's center coordinates (latitude, longitude)
    const vigoCenter = [42.2327, -8.7225];

    // Array of top 10 attractions in Vigo with their coordinates
    let xplaces = [
      { name: "Castro Park", lat: 42.2229, lng: -8.7137 },
      { name: "Samil Beach", lat: 42.2040, lng: -8.7625 },
      { name: "Vigo Cathedral", lat: 42.2335, lng: -8.7237 },
      { name: "Monte do Castro", lat: 42.2243, lng: -8.7142 },
      { name: "Museo do Mar", lat: 42.2230, lng: -8.7250 },
      { name: "Casco Vello", lat: 42.2320, lng: -8.7230 },
      { name: "Islas Cíes", lat: 42.1983, lng: -8.8825 },
      { name: "Estadio Balaídos", lat: 42.2225, lng: -8.7320 },
      { name: "Parque de la Alameda", lat: 42.2305, lng: -8.7255 },
      { name: "Praza da Princesa", lat: 42.2310, lng: -8.7240 }
    ];

    // Function to calculate distance between two points using Haversine formula
    function calculateDistance(lat1, lon1, lat2, lon2) {
      const R = 6371; // Earth radius in km
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a =
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLon / 2) * Math.sin(dLon / 2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c * 0.621371; // Convert to miles
    }

    // Add distances between consecutive elements and from Vigo's center
    for (let i = 0; i < xplaces.length; i++) {
      if (i < xplaces.length - 1) {
        const nextPlace = xplaces[i + 1];
        xplaces[i].distanceToNext = calculateDistance(
          xplaces[i].lat, xplaces[i].lng,
          nextPlace.lat, nextPlace.lng
        );
      } else {
        xplaces[i].distanceToNext = null; // No next element for the last one
      }
      xplaces[i].distanceFromCenter = calculateDistance(
        xplaces[i].lat, xplaces[i].lng,
        vigoCenter[0], vigoCenter[1]
      );
    }

    // Sort xplaces by distance to the next element
    xplaces.sort((a, b) => (a.distanceToNext || Infinity) - (b.distanceToNext || Infinity));

    // Initialize Leaflet map
    const map = L.map('map').setView(vigoCenter, 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
    }).addTo(map);

    let currentElement = 0;

    // Function to display markers for the current and next elements
    function displayMarkers() {
      map.eachLayer(layer => {
        if (layer instanceof L.Marker) {
          map.removeLayer(layer); // Remove all existing markers
        }
      });

      const currentPlace = xplaces[currentElement];
      const nextPlace = xplaces[currentElement + 1];

      // Add marker for the current element
      const currentMarker = L.marker([currentPlace.lat, currentPlace.lng]).addTo(map);
      currentMarker.bindPopup(`${currentPlace.name}`).openPopup();

      // Add marker for the next element
      if (nextPlace) {
        const nextMarker = L.marker([nextPlace.lat, nextPlace.lng]).addTo(map);
        nextMarker.bindPopup(
          `${nextPlace.name}<br>` +
          `Distance to next: ${currentPlace.distanceToNext.toFixed(2)} miles<br>` +
          `Distance from Vigo center: ${nextPlace.distanceFromCenter.toFixed(2)} miles`
        ).openPopup();
      }
    }

    // Display markers for the first pair
    displayMarkers();

    // Increment currentElement and update markers on button click
    document.addEventListener('click', () => {
      if (currentElement < xplaces.length - 1) {
        currentElement++;
        displayMarkers();
      } else {
        alert("Reached the end of the list!");
      }
    });
  </script>
</body>
</html>